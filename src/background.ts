const stychContentDb = [{ id: "L'écomobilité\n        \n            \n                \n               2 min\n            \n\n                        \n                \n                Dernier score 5/5", parent: '8/124', title: "L'écomobilité\n        \n            \n                \n               2 min\n            \n\n                        \n                \n                Dernier score 5/5" }, { id: "L'écoconduite\n        \n            \n                \n               5 min", parent: '8/124', title: "L'écoconduite\n        \n            \n                \n               5 min" }, { id: 'Équipements du conducteur\n        \n            \n                \n               7 min', parent: '8/123', title: 'Équipements du conducteur\n        \n            \n                \n               7 min' }, { id: 'Vérifications et entretien de la moto\n        \n            \n                \n               6 min', parent: '8/123', title: 'Vérifications et entretien de la moto\n        \n            \n                \n               6 min' }, { id: 'Équipements de la moto\n        \n            \n                \n               3 min', parent: '8/122', title: 'Équipements de la moto\n        \n            \n                \n               3 min' }, { id: 'Vérifications et entretien de la moto\n        \n            \n                \n               6 min', parent: '8/122', title: 'Vérifications et entretien de la moto\n        \n            \n                \n               6 min' }, { id: 'Accident corporel\n        \n            \n                \n               6 min\n            \n\n                        \n                \n                Dernier score 5/5', parent: '8/121', title: 'Accident corporel\n        \n            \n                \n               6 min\n            \n\n                        \n                \n                Dernier score 5/5' }, { id: 'La réglementation de la vitesse\n        \n            \n                \n               3 min\n            \n\n                        \n                \n                Dernier score 5/5', parent: '8/119', title: 'La réglementation de la vitesse\n        \n            \n                \n               3 min\n            \n\n                        \n                \n                Dernier score 5/5' }, { id: 'La signalisation de la vitesse\n        \n            \n                \n               1 min\n            \n\n                        \n                \n                Dernier score 5/5', parent: '8/119', title: 'La signalisation de la vitesse\n        \n            \n                \n               1 min\n            \n\n                        \n                \n                Dernier score 5/5' }, { id: 'Notions sur les différentes forces\n        \n            \n                \n               1 min', parent: '8/119', title: 'Notions sur les différentes forces\n        \n            \n                \n               1 min' }, { id: 'La circulation inter-files\n        \n            \n                \n               2 min', parent: '8/119', title: 'La circulation inter-files\n        \n            \n                \n               2 min' }, { id: 'La trajectoire de sécurité\n        \n            \n                \n               2 min', parent: '8/119', title: 'La trajectoire de sécurité\n        \n            \n                \n               2 min' }, { id: "Circulation la nuit et en cas d'intempéries\n        \n            \n                \n               6 min", parent: '8/119', title: "Circulation la nuit et en cas d'intempéries\n        \n            \n                \n               6 min" }, { id: 'Le permis de conduire\n        \n            \n                \n               4 min\n            \n\n                        \n                \n                Dernier score 5/5', parent: '8/120', title: 'Le permis de conduire\n        \n            \n                \n               4 min\n            \n\n                        \n                \n                Dernier score 5/5' }, { id: 'Le permis à points\n        \n            \n                \n               7 min\n            \n\n                        \n                \n                Dernier score 4/5', parent: '8/120', title: 'Le permis à points\n        \n            \n                \n               7 min\n            \n\n                        \n                \n                Dernier score 4/5' }, { id: 'Documents obligatoires et utiles\n        \n            \n                \n               2 min', parent: '8/120', title: 'Documents obligatoires et utiles\n        \n            \n                \n               2 min' }, { id: 'Tableau des sanctions\n        \n            \n                \n               1 min', parent: '8/120', title: 'Tableau des sanctions\n        \n            \n                \n               1 min' }, { id: "Les différents types d'usagers\n        \n            \n                \n               8 min", parent: '8/118', title: "Les différents types d'usagers\n        \n            \n                \n               8 min" }, { id: 'Code de la rue\n        \n            \n                \n               1 min', parent: '8/118', title: 'Code de la rue\n        \n            \n                \n               1 min' }, { id: 'La circulation inter-files\n        \n            \n                \n               2 min', parent: '8/118', title: 'La circulation inter-files\n        \n            \n                \n               2 min' }, { id: "L'état du conducteur\n        \n            \n                \n               3 min", parent: '8/117', title: "L'état du conducteur\n        \n            \n                \n               3 min" }, { id: 'Alcool et conduite\n        \n            \n                \n               5 min', parent: '8/117', title: 'Alcool et conduite\n        \n            \n                \n               5 min' }, { id: 'Les distances à respecter\n        \n            \n                \n               5 min', parent: '8/117', title: 'Les distances à respecter\n        \n            \n                \n               5 min' }, { id: 'La signalisation verticale\n        \n            \n                \n               5 min\n            \n\n                        \n                \n                Dernier score 4/5', parent: '8/116', title: 'La signalisation verticale\n        \n            \n                \n               5 min\n            \n\n                        \n                \n                Dernier score 4/5' }, { id: 'La signalisation horizontale\n        \n            \n                \n               4 min', parent: '8/116', title: 'La signalisation horizontale\n        \n            \n                \n               4 min' }, { id: 'La signalisation temporaire\n        \n            \n                \n               2 min\n            \n\n                        \n                \n                Dernier score 5/5', parent: '8/116', title: 'La signalisation temporaire\n        \n            \n                \n               2 min\n            \n\n                        \n                \n                Dernier score 5/5' }, { id: 'Planche de panneaux\n        \n            \n                \n               1 min\n            \n\n                        \n                \n                Dernier score 5/5', parent: '8/116', title: 'Planche de panneaux\n        \n            \n                \n               1 min\n            \n\n                        \n                \n                Dernier score 5/5' }, { id: 'Les règles de priorité\n        \n            \n                \n               6 min', parent: '8/116', title: 'Les règles de priorité\n        \n            \n                \n               6 min' }, { id: 'Carrefours à sens giratoire et ronds points\n        \n            \n                \n               3 min', parent: '8/116', title: 'Carrefours à sens giratoire et ronds points\n        \n            \n                \n               3 min' }, { id: 'Les feux\n        \n            \n                \n               4 min', parent: '8/116', title: 'Les feux\n        \n            \n                \n               4 min' }, { id: "L'arrêt et le stationnement en moto\n        \n            \n                \n               4 min", parent: '8/116', title: "L'arrêt et le stationnement en moto\n        \n            \n                \n               4 min" }, { id: 'Placement sur la chaussée\n        \n            \n                \n               1 min', parent: '8/116', title: 'Placement sur la chaussée\n        \n            \n                \n               1 min' }, { id: 'Les tunnels\n        \n            \n                \n               2 min', parent: '8/116', title: 'Les tunnels\n        \n            \n                \n               2 min' }, { id: 'Passage à niveau\n        \n            \n                \n               1 min', parent: '8/116', title: 'Passage à niveau\n        \n            \n                \n               1 min' }, { id: 'La forme, la couleur et les symboles des panneaux :', link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: 'La forme, la couleur et les symboles des panneaux :' }, { id: 'Les panneaux de danger :', link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: 'Les panneaux de danger :' }, { id: "Les panneaux d'interdiction :", link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: "Les panneaux d'interdiction :" }, { id: "Les panneaux d'obligation :", link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: "Les panneaux d'obligation :" }, { id: "Les panneaux d'indication :", link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: "Les panneaux d'indication :" }, { id: 'Les panneaux de localisation :', link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: 'Les panneaux de localisation :' }, { id: 'Les panneaux de direction :', link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: 'Les panneaux de direction :' }, { id: 'Les balises et bornes :', link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: 'Les balises et bornes :' }, { id: 'Derniers scores', link: 'https://www.stych.fr/elearning/fiche-cours/8/221', parent: '8/221', title: 'Derniers scores' }]

chrome.runtime.onInstalled.addListener(() => {
  chunkedWrite('stychContent', stychContentDb)

  console.log(`Added ${stychContentDb.length} Stych categories`)
})

function chunkedWrite (key: string, value: object) {
  return new Promise(resolve => {
    if (typeof key !== 'string') key = `${key}`
    const str = JSON.stringify(value) // consider using LZString's compressToUTF16
    const len = chrome.storage.sync.QUOTA_BYTES_PER_ITEM - key.length - 1000
    const num = Math.ceil(str.length / len)
    const obj: { [key: string]: string | number } = {}
    obj[key + '#'] = num
    for (let i = 0; i < num; i++) {
      obj[key + i] = str.substr(i * len, len)
    }
    chrome.storage.sync.set(obj, () => resolve('done'))
  })
}
